<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Pong + Algoritmo Gen√©tico em JavaScript</title>
  <link rel="stylesheet" href="css/estilos.css">
</head>
<body>
  <div id="container">
    <div id="leftColumn">
      <div class="panel">
        <h1>üéÆ Pong + Algoritmo Gen√©tico</h1>
        <div id="info"></div>
        <div style="margin-top:8px;">
          <button id="toggleTrainingBtn">Pausar Treinamento</button>
          <button id="resetBtn">Resetar Popula√ß√£o</button>
        </div>

        <div class="info-section">
          <h3>üìö Como Funciona o Treinamento</h3>
          <ul>
            <li><strong>Rede Neural Artificial (RNA):</strong> Arquitetura feedforward com 6 entradas (posi√ß√£o/velocidade da bola e raquete), 8 neur√¥nios na camada oculta e 1 sa√≠da (movimento da raquete). Usa fun√ß√£o de ativa√ß√£o tanh (tangente hiperb√≥lica) para normalizar valores entre -1 e 1. Os pesos e vieses s√£o codificados como genoma.</li>
            <li><strong>Algoritmo Gen√©tico (AG):</strong> Evolui uma popula√ß√£o de redes neurais atrav√©s de ciclos de avalia√ß√£o, sele√ß√£o, crossover e muta√ß√£o. Cada genoma representa os pesos e vieses de uma rede neural completa.</li>
            <li><strong>Inicializa√ß√£o:</strong> Popula√ß√£o inicial criada com genomas aleat√≥rios (valores entre -1 e 1) usando distribui√ß√£o uniforme.</li>
            <li><strong>Avalia√ß√£o de Fitness:</strong> Cada rede joga m√∫ltiplos epis√≥dios de Pong. O fitness √© calculado como: <code>passos + rebatidas √ó 200</code>, onde passos = tempo de sobreviv√™ncia. O fitness final √© a m√©dia entre todos os epis√≥dios.</li>
            <li><strong>Normaliza√ß√£o de Estado:</strong> Os estados do jogo (posi√ß√µes e velocidades) s√£o normalizados para o intervalo [-1, 1] antes de serem enviados √† rede neural, facilitando o aprendizado.</li>
            <li><strong>Sele√ß√£o por Torneio:</strong> Para escolher pais, seleciona aleatoriamente k=3 indiv√≠duos e escolhe o de maior fitness. Este m√©todo mant√©m diversidade e press√£o seletiva.</li>
            <li><strong>Elitismo:</strong> Os N melhores indiv√≠duos (elites) s√£o preservados intactos na pr√≥xima gera√ß√£o, garantindo que solu√ß√µes boas n√£o sejam perdidas.</li>
            <li><strong>Crossover de Um Ponto:</strong> Combina dois genomas pais escolhendo um ponto aleat√≥rio de corte. Os genes antes do ponto v√™m do pai 1, os depois do pai 2, criando um filho h√≠brido.</li>
            <li><strong>Muta√ß√£o Gaussiana:</strong> Cada gene tem uma probabilidade (taxa de muta√ß√£o) de ser modificado. A muta√ß√£o adiciona um valor aleat√≥rio de distribui√ß√£o normal (Gaussiana) com m√©dia 0 e desvio padr√£o configur√°vel, permitindo explora√ß√£o do espa√ßo de solu√ß√µes.</li>
            <li><strong>Gera√ß√£o de N√∫meros Aleat√≥rios:</strong> Usa m√©todo Box-Muller para gerar n√∫meros com distribui√ß√£o normal (Gaussiana) necess√°rio para muta√ß√£o, e distribui√ß√£o uniforme para inicializa√ß√£o e sele√ß√£o.</li>
            <li><strong>F√≠sica do Jogo:</strong> Implementa detec√ß√£o de colis√µes, acelera√ß√£o progressiva da bola (1.03x por rebatida), zona morta para movimento suave da raquete (s√≥ move se a√ß√£o > 0.15), e normaliza√ß√£o de a√ß√µes para evitar movimentos bruscos.</li>
            <li><strong>Ciclo Evolutivo:</strong> A cada gera√ß√£o: (1) Avalia toda a popula√ß√£o, (2) Preserva elites, (3) Preenche o resto com filhos gerados por sele√ß√£o + crossover + muta√ß√£o, (4) Repete at√© converg√™ncia ou crit√©rio de parada.</li>
          </ul>
        </div>

        <div class="controls-section">
          <h3 style="margin-top:0; margin-bottom:16px; font-size:14px; color:#4CAF50;">‚öôÔ∏è Par√¢metros do Algoritmo</h3>
          
          <div class="controls-grid">
            <div class="control-group">
              <label>
                <span>Tamanho da Popula√ß√£o</span>
                <span class="value-display" id="popSizeValue">30</span>
              </label>
              <input type="range" id="popSizeSlider" min="10" max="100" value="30" step="5">
            </div>

            <div class="control-group">
              <label>
                <span>N√∫mero de Elites</span>
                <span class="value-display" id="eliteCountValue">4</span>
              </label>
              <input type="range" id="eliteCountSlider" min="1" max="10" value="4" step="1">
            </div>

            <div class="control-group">
              <label>
                <span>Taxa de Muta√ß√£o</span>
                <span class="value-display" id="mutationRateValue">0.15</span>
              </label>
              <input type="range" id="mutationRateSlider" min="0.05" max="0.5" value="0.15" step="0.05">
            </div>

            <div class="control-group">
              <label>
                <span>Desvio Padr√£o da Muta√ß√£o</span>
                <span class="value-display" id="mutationStdValue">0.3</span>
              </label>
              <input type="range" id="mutationStdSlider" min="0.1" max="1.0" value="0.3" step="0.1">
            </div>

            <div class="control-group">
              <label>
                <span>Epis√≥dios por Genoma</span>
                <span class="value-display" id="episodesValue">2</span>
              </label>
              <input type="range" id="episodesSlider" min="1" max="5" value="2" step="1">
            </div>

            <div class="control-group">
              <label>
                <span>M√°x. Passos por Epis√≥dio</span>
                <span class="value-display" id="maxStepsValue">600</span>
              </label>
              <input type="range" id="maxStepsSlider" min="200" max="1000" value="600" step="100">
            </div>
          </div>

          <div class="apply-button-container">
            <button id="applyParamsBtn" class="btn-apply">Aplicar Par√¢metros</button>
            <div id="pendingChangesMsg" class="pending-changes" style="display:none;">
              ‚ö†Ô∏è Altera√ß√µes pendentes - clique em "Aplicar Par√¢metros" para aplicar
            </div>
          </div>
        </div>
      </div>
      <div class="panel">
        <h2>üéØ Todos os Jogos</h2>
        <div id="gamesRow">
          <div class="gamePanel">
            <h3>Principal (melhor)</h3>
            <canvas id="pongCanvas" width="200" height="150"></canvas>
          </div>
          <div class="gamePanel">
            <h3>Jogo 1</h3>
            <canvas id="game1Canvas" width="200" height="150"></canvas>
          </div>
          <div class="gamePanel">
            <h3>Jogo 2</h3>
            <canvas id="game2Canvas" width="200" height="150"></canvas>
          </div>
          <div class="gamePanel">
            <h3>Jogo 3</h3>
            <canvas id="game3Canvas" width="200" height="150"></canvas>
          </div>
        </div>
      </div>
    </div>

    <div id="rightColumn">
      <div class="panel">
        <h2>üß† Rede Neural (melhor indiv√≠duo)</h2>
        <canvas id="nnCanvas" width="1000" height="700"></canvas>
      </div>
      <div class="panel">
        <h2>üìà Evolu√ß√£o do Fitness</h2>
        <canvas id="plotCanvas" width="1000" height="450"></canvas>
      </div>
    </div>
  </div>

  <!-- Scripts na ordem correta de depend√™ncias -->
  <script src="js/config.js"></script>
  <script src="js/utilidades.js"></script>
  <script src="js/redeNeural.js"></script>
  <script src="js/ambientePong.js"></script>
  <script src="js/algoritmoGenetico.js"></script>
  <script src="js/visualizacao.js"></script>
  <script src="js/controles.js"></script>
  <script src="js/main.js"></script>
</body>
</html>
